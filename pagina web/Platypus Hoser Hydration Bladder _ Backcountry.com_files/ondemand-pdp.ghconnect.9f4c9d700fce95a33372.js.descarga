webpackJsonp([7],{312:function(t,e,n){var a;a=function(t,e,a){function i(){window.lp_start_chat=h}function l(){b.unmountElementsAt($(document),x)}function o(){r(),C=null,j=0,N=[],S={}}function r(){_.each(N,function(t){var e=$(t.selector);e.ghconnect("destroy"),_.isFunction(t.callbacks.onDestroy)&&t.callbacks.onDestroy()})}function s(t,e,n){_.isEmpty(C)&&(C=t,j=t.engagementId,i()),_.each(e,function(t){var e=t.gearheadLivepersonUsername;e?t.selectedGearhead=y.selectSpecificGearhead(e,C):t.selectedGearhead=y.selectConnectedGearheadOrSkill(C)}),u(e),N=N.concat(e),_.isFunction(n)&&n()}function c(t,e,a){G.start("ondemand-chat",!0),n.e(64,function(i){b=n(129),v=n(521),g=n(513),d(t,e,a)})}function u(t){_.each(t,function(t){var e=t.selectedGearhead;if(!_.isEmpty(e)){var a=$(t.selector),i=t.templates["default"],l=y.getInstancesData(e,C);a.ghconnect({callback:t.callbacks.onTemplateRendered,chatAction:_.bind(m,this),template:n(617)("./"+i+".tpl"),templateData:_.extend({},l,t.data)})}})}function d(t,e,n){b.renderIntoElement(v,_.last($(x)),{chatData:e,engagementData:t||{},restored:n,lpChat:g,onComponentReady:function(){G.end()},onStartChat:function(t,e){y.backupChatState(e),y.createOpportunity(C,t)},onStopChat:y.removeChatStateBackup,onUpdateChat:f,unmountChat:l})}function p(t){var e=!0;t.isChatting=!0,c({},t,e)}function h(t){c(t,y.getChatData(S,C),!1),S={}}function m(t){t&&(S=C.getGearheadByLivepersonUsername(t),lpTag.taglets.rendererStub.click(j))}function f(t){var e=C.getGearheadByLivepersonUsername(t);e?(S=e,r(),_.each(N,function(t){t.selectedGearhead=e}),u(N)):r()}n(618);var b,v,g,y=n(554),k=n(281),x=".js-gh-chat-container",C=null,j=0,N=[],S={},G=new k;a.exports={destroy:o,init:s,restoreChat:p}}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))},554:function(t,e,n){var a;a=function(t,e,a){function i(t){has("sessionstorage")&&t&&sessionStorage.setItem("activeChat",JSON.stringify(t))}function l(t,e){var n=e&&e.info||{},a=t.getGearheadByLivepersonUsername(n.agentName);BC.user.isRegistered&&BC.profile&&a&&g.createOpportunity({classification:"alert",customerId:BC.profile.id,gearheadId:a._id.userId,leadType:"chat"})}function o(t,e){var n=BC.getClientSession(),a=BC.getSessionId()||"",i=t.displayName,l=h(i),o=d(t._id.userId,e),r=v(e),u=r._id||C,p=r.name||j,m=y+u,f=_.extend({firstName:l.firstName,generalFallback:s(e),imageUrl:c(t.imageId),isConnectedGearhead:o,isMobile:has("mobile")||!1,lpSkillId:m,skillId:u,skillName:p,uid:n,sessionId:a,type:o?x:k},t);return f}function r(t,e){var n=t.displayName,a=d(t._id.userId,e),i=h(n),l=v(e),o=l.name||j,r=_.extend({customName:a?$.t("label.gearhead.your"):n,firstName:i.firstName,imageUrl:c(t.imageId),isConnectedGearhead:a,isMobile:has("mobile")||!1,restOfName:i.restOfName,skillName:o},t);return r}function s(t){var e=has("ghxdevpassions")?{_id:"dev-test-fallback"}:t.getGeneralSkill(),n=e&&y+e._id;return n}function c(t){return N+t+S}function u(t){return!!(t&&t.availability&&t.availability.chat)}function d(t,e){var n=e.getConnectedGearhead();return p(n)&&n._id.userId===t}function p(t){return!!(t&&t._id&&t._id.userId&&t.livepersonUsername)}function h(t){var e="",n="";if(t){var a=t.split(" ");e=a[0],n=a.slice(1).join(" ")}return{firstName:e,restOfName:n}}function m(){has("sessionstorage")&&sessionStorage.removeItem("activeChat")}function f(t){var e={},n=t.getConnectedGearhead(),a=p(n);if(a)e=n;else{var i=v(t);e=i._id?_.sample(t.getOnlineGearheadsByPassion(i._id)):{}}return e}function b(t,e){var n=e.getGearheadByLivepersonUsername(t);return p(n)&&(n.isConnectedGearhead=d(n._id.userId,e)),n}function v(t){var e=t.contextSkills;return e&&e[0]||{}}var g=n(565),y="ghcxn-",k="skill",x="gearhead",C="general",j="gear",N="//iris.backcountry.com/image/view/",S="/150/150";a.exports={backupChatState:i,createOpportunity:l,getChatData:o,getInstancesData:r,isGearheadAvailable:u,removeChatStateBackup:m,selectConnectedGearheadOrSkill:f,selectSpecificGearhead:b}}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))},565:function(t,e,n){var a;a=function(t){function e(t){return t=t||{},t.cache=!0,t.timeout=a.timeout,$.ajax(t).fail(function(e,n,a){$.error("textStatus: "+n+" errorThrown: "+a+" serviceUrl: "+t.url+" readyState: "+e.readyState+" status: "+e.status+" responseText: "+e.responseText+" responseJSON: "+JSON.stringify(e.responseJSON),"common/services/opportunity-service.js")})}function n(t){return t=t||{},t.gearheadId?e({contentType:"application/json",data:JSON.stringify(t),dataType:a.dataType,method:"POST",url:"/Store/services/gearhead/"+t.gearheadId+"/opportunity"}):$.Deferred().reject().promise()}var a={dataType:"json",timeout:1e4};return{createOpportunity:n}}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))},617:function(t,e,n){function a(t){return n(i(t))}function i(t){return l[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var l={"./bc.flyout.tpl":712,"./bc.gearguide.tpl":713,"./bc.gearhead.default.tpl":714};a.keys=function(){return Object.keys(l)},a.resolve=i,t.exports=a,a.id=617},618:function(t,e,n){var a;a=function(){$.widget("bc.ghconnect",{options:{callback:$.noop,chatAction:$.noop,chatButtonClass:".js-ghcxn-chat",template:null,templateData:{dotLineClass:"",widgetLocation:""}},_create:function(){var t=this,e=t.options;e.template&&(this.element.append(e.template(e.templateData)),this._on(this.element.find(e.chatButtonClass),{click:t._chatAction}),e.callback(this))},_chatAction:function(t){var e=$(t.currentTarget);this.options.chatAction(e.data("livepersonusername"))},_destroy:function(){this.element.empty()},getTemplateData:function(){return this.options.templateData}})}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))},712:function(module,exports,__webpack_require__){var _=__webpack_require__(4);module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="js-flyout-ghx-actions hidden">\n    ',isConnectedGearhead?(__p+='\n        <div class="flyout-ghx__intro">\n            <div class="flyout-ghx__photo" style="background-image: url(\''+(null==(__t=imageUrl)?"":__t)+'\')"></div>\n            <span class="flyout_ghx__name">'+(null==(__t=firstName)?"":__t)+'</span>\n            <span class="flyout_ghx__name flyout_ghx__name-rest">'+(null==(__t=restOfName)?"":__t)+'</span>\n        </div>\n        <div class="flyout-ghx__contact">\n            ',availability&&availability.chat?__p+='\n                <button\n                    class="btn btn-primary flyout-ghx__btn-contact js-ghcxn-chat omniture-track-click"\n                    data-livepersonUsername="'+(null==(__t=livepersonUsername)?"":__t)+'"\n                    data-omniture-method="ScTrackClickGhxChatBtn"\n                    data-omniture-params="'+(null==(__t=widgetLocation)?"":__t)+'">'+(null==(__t=$.t("label.talk.to",firstName))?"":__t)+"\n                </button>\n            ":(__p+="\n                ",__p+=isMobile?'\n                    <a href="tel:+1.'+(null==(__t=phone)?"":__t)+'" class="btn btn-primary flyout-ghx__btn-phone">'+(null==(__t=$.t("label.account.gearhead.call",firstName))?"":__t)+"</a>\n                ":'\n                    <span class="flyout-ghx__phone">'+(null==(__t="+1."+phone)?"":__t)+"</span>\n                ",__p+='\n                <a href="mailto:'+(null==(__t=email)?"":__t)+'" class="flyout-ghx__email">'+(null==(__t=email)?"":__t)+'</a>\n                <a href="mailto:'+(null==(__t=email)?"":__t)+'" class="btn btn-secondary flyout-ghx__btn-email">'+(null==(__t=$.t("label.email")+" "+firstName)?"":__t)+"</a>\n            "),__p+="\n        </div>\n    "):__p+='\n        <p class="flyout-ghx__message">\n            <span class="flyout-ghx__message-txt">\n              <i class="gearhead-help__dot"></i> '+(null==(__t=$.t("label.gearheads.online"))?"":__t)+'</span>\n        </p>\n        <button\n            class="btn btn-primary flyout-ghx__btn js-ghcxn-chat omniture-track-click"\n            data-livepersonUsername="'+(null==(__t=livepersonUsername)?"":__t)+'"\n            data-omniture-method="ScTrackClickGhxChatBtn"\n            data-omniture-params="'+(null==(__t=widgetLocation)?"":__t)+'">'+(null==(__t=$.t("label.talk.to.gearhead"))?"":__t)+"\n        </button>\n    ",__p+="\n</div>\n";return __p}},713:function(module,exports,__webpack_require__){var _=__webpack_require__(4);module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="intro-card__block intro-card__contact js-intro-card__contact">\n    ',__p+=availability&&availability.chat?'\n    <div class="intro-card__online">\n        <span class="intro-card__online-dot"></span>\n        '+(null==(__t=$.t("label.is.online",firstName))?"":__t)+'\n    </div>\n    <button\n        class="btn btn-secondary connect__btn js-ghcxn-chat js-gearguide-chat omniture-track-click"\n        data-livepersonUsername="'+(null==(__t=livepersonUsername)?"":__t)+'"\n        data-omniture-method="ScTrackClickGhxChatBtn"\n        data-omniture-params="'+(null==(__t=widgetLocation)?"":__t)+'">'+(null==(__t=$.t("label.talk.to",firstName))?"":__t)+"\n    </button>\n    ":'\n        <a class="intro-card__details intro-card__details-phone" href="tel:+1.'+(null==(__t=phone)?"":__t)+'">'+(null==(__t=phone)?"":__t)+'</a>\n        <a class="intro-card__details intro-card__details-email" href="mailto:'+(null==(__t=email)?"":__t)+'">'+(null==(__t=email)?"":__t)+"</a>\n    ",__p+="\n</div>\n";return __p}},714:function(module,exports,__webpack_require__){var _=__webpack_require__(4);module.exports=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=Array.prototype.join;with(obj)__p+='<div class="connect__wrapper">\n    <div class="connect__icon"></div>\n    <div class="connect__intro">\n        <div class="connect__photo" style="background-image: url(\''+(null==(__t=imageUrl)?"":__t)+'\')"></div>\n        <div class="connect__content">\n            <h2 class="connect__title">'+(null==(__t=$.t(title,skillName))?"":__t)+"</h2>\n        </div>\n        ",availability&&availability.chat?__p+='\n            <div class="gearhead-help__dot '+(null==(__t=dotLineClass)?"":__t)+'"></div>\n            <span class="connect__available '+(null==(__t=dotLineClass)?"":__t)+'">'+(null==(__t=$.t("label.is.available",customName))?"":__t)+"</span>\n        ":(__p+="\n            ",isMobile||(__p+='\n                <span class="connect__unavailable-phone">'+(null==(__t="+1."+phone)?"":__t)+"</span>\n            "),__p+="\n        "),__p+="\n    </div>\n    ",availability&&availability.chat?__p+='\n        <button\n            class="btn btn-secondary connect__btn js-ghcxn-chat omniture-track-click"\n            data-livepersonUsername="'+(null==(__t=livepersonUsername)?"":__t)+'"\n            data-omniture-method="ScTrackClickGhxChatBtn"\n            data-omniture-params="'+(null==(__t=widgetLocation)?"":__t)+'">'+(null==(__t=$.t("label.talk.to",firstName))?"":__t)+"\n        </button>\n    ":(__p+="\n        ",__p+=isMobile?'\n            <a href="mailto:'+(null==(__t=email)?"":__t)+'" class="btn btn-secondary connect__unavailable-btn-mobile-email">'+(null==(__t=$.t("label.email")+" "+firstName)?"":__t)+'</a>\n            <a href="tel:+1.'+(null==(__t=phone)?"":__t)+'" class="btn btn-secondary connect__unavailable-btn-mobile-phone">'+(null==(__t=$.t("label.account.gearhead.call",firstName))?"":__t)+"</a>\n        ":'\n            <a href="mailto:'+(null==(__t=email)?"":__t)+'" class="btn btn-secondary connect__unavailable-btn">'+(null==(__t=$.t("label.email")+" "+firstName)?"":__t)+"</a>\n        ",__p+="\n    "),__p+="\n</div>\n";return __p}}});
//# sourceMappingURL=ondemand-pdp.ghconnect.9f4c9d700fce95a33372.js.map